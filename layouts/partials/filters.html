{{- $taxonomies := $.Site.Data.taxonomies -}}

{{- $stakeholderCounts := $.Site.Taxonomies.stakeholders -}}
{{- $streamCounts := $.Site.Taxonomies.capability_streams -}}
{{- $domainCounts := $.Site.Taxonomies.capability_domains -}}
{{- $industrialCounts := $.Site.Taxonomies.industrial_capabilities -}}
{{- $regionCounts := $.Site.Taxonomies.regions -}}
{{- $ownershipCounts := $.Site.Taxonomies.ownerships -}}

  <div class="filters-scroll">
    <!-- Capability Streams -->
    <details class="filter-details" open>
      <summary>Capability Streams</summary>
      <div class="stream-icons">
        {{- range $key, $name := $taxonomies.capability_streams }}
        <label class="stream-icon" title="{{ $name }} ({{ with index $streamCounts $key }}{{ .Count }}{{ else }}0{{ end }})">
          <input type="checkbox" name="capability_streams" value="{{ $key }}">
          <img src="{{ printf "icons/streams/%s.png" $key | relURL }}" alt="{{ $name }}" loading="lazy">
        </label>
        {{- end }}
      </div>
    </details>

    <!-- Ownership -->
    <details class="filter-details" open>
      <summary>Ownership</summary>
      <div class="stream-icons">
        {{- range $key, $name := $taxonomies.ownerships }}
        <label class="stream-icon" title="{{ $name }} ({{ with index $ownershipCounts $key }}{{ .Count }}{{ else }}0{{ end }})">
          <input type="checkbox" name="ownerships" value="{{ $key }}">
          <img src="{{ printf "icons/ownerships/%s.png" $key | relURL }}" alt="{{ $name }}" loading="lazy">
        </label>
        {{- end }}
      </div>
    </details>

    <!-- Stakeholders -->
    <details class="filter-details" open>
      <summary>Stakeholders</summary>
      <div class="filter-options">
        {{- range $key, $name := $taxonomies.stakeholders }}
        <label class="filter-item">
          <input type="checkbox" name="stakeholders" value="{{ $key }}">
          <span>{{ $name }}</span>
          <small class="filter-count">{{ with index $stakeholderCounts $key }}{{ .Count }}{{ else }}0{{ end }}</small>
        </label>
        {{- end }}
      </div>
    </details>

    <!-- Regions -->
    <details class="filter-details">
      <summary>Regions</summary>
      <div class="filter-options">
        {{- range $key, $name := $taxonomies.regions }}
        <label class="filter-item">
          <input type="checkbox" name="regions" value="{{ $key }}">
          <span>{{ $name }}</span>
          <small class="filter-count">{{ with index $regionCounts $key }}{{ .Count }}{{ else }}0{{ end }}</small>
        </label>
        {{- end }}
      </div>
    </details>

    <!-- Capability Domains -->
    <details class="filter-details">
      <summary>Capability Domains</summary>
      <div class="filter-options">
        {{- range $key, $name := $taxonomies.capability_domains }}
        <label class="filter-item">
          <input type="checkbox" name="capability_domains" value="{{ $key }}">
          <span>{{ $name }}</span>
          <small class="filter-count">{{ with index $domainCounts $key }}{{ .Count }}{{ else }}0{{ end }}</small>
        </label>
        {{- end }}
      </div>
    </details>

    <!-- Industrial Capabilities -->
    <details class="filter-details">
      <summary>Industrial Capabilities</summary>
      <div class="filter-options">
        {{- range $key, $name := $taxonomies.industrial_capabilities }}
        <label class="filter-item">
          <input type="checkbox" name="industrial_capabilities" value="{{ $key }}">
          <span>{{ $name }}</span>
          <small class="filter-count">{{ with index $industrialCounts $key }}{{ .Count }}{{ else }}0{{ end }}</small>
        </label>
        {{- end }}
      </div>
    </details>
  </div>
