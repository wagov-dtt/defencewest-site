---
interface Props {
  company: {
    slug: string;
    name: string;
    overview?: string;
    logo_url?: string;
    is_prime?: boolean;
    is_sme?: boolean;
    is_indigenous_owned?: boolean;
    is_veteran_owned?: boolean;
  };
  compact?: boolean;
}

const { company, compact = false } = Astro.props;

const hasBadges = company.is_prime || company.is_sme || company.is_indigenous_owned || company.is_veteran_owned;
---

<a href={`/company/${company.slug}`} class:list={["company-card", { compact }]}>
  <article>
    <div class="logo-area">
      {
        company.logo_url ? (
          <img src={company.logo_url} alt="" loading="lazy" />
        ) : (
          <span class="initials">{company.name.slice(0, 2).toUpperCase()}</span>
        )
      }
    </div>

    <div class="name">{company.name}</div>

    {
      hasBadges && (
        <div class="badges">
          {company.is_prime && <small>Prime</small>}
          {company.is_sme && <small>SME</small>}
          {company.is_indigenous_owned && <small class="highlight">Indigenous</small>}
          {company.is_veteran_owned && <small class="highlight">Veteran</small>}
        </div>
      )
    }

    {
      company.overview && (
        <p class="overview">
          <small>{company.overview}</small>
        </p>
      )
    }
  </article>
</a>

<style>
  .company-card {
    text-decoration: none;
    color: inherit;
    display: block;
    height: 100%;
  }

  .company-card:hover article {
    background-color: var(--pico-muted-border-color);
  }

  article {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    height: 100%;
    padding: 1rem;
    transition: background-color 0.15s;
  }

  .badges {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.25rem;
    margin-bottom: 0.5rem;
  }

  .badges small {
    padding: 0.1rem 0.4rem;
    background: var(--pico-muted-border-color);
    border-radius: var(--pico-border-radius);
    font-size: 0.7rem;
    opacity: 0.7;
  }

  .badges small.highlight {
    opacity: 0.85;
  }

  .logo-area {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 60px;
    margin-bottom: 0.75rem;
  }

  .logo-area img {
    max-width: 100%;
    max-height: 60px;
    width: auto;
    height: auto;
    object-fit: contain;
  }

  .initials {
    font-size: 1.5rem;
    font-weight: bold;
    opacity: 0.4;
  }

  .name {
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
    font-weight: bold;
  }

  .overview {
    margin: 0;
    flex: 1;
    opacity: 0.7;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    overflow: hidden;
  }

  /* Compact variant - less padding for map popups */
  .compact {
    height: auto;
  }

  .compact article {
    padding: 0.75rem;
    height: auto;
    box-shadow: none;
    margin: 0;
  }
</style>
